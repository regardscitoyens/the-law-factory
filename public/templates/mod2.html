<div class="row">
  <div class="cont-width offset-width" style="background-color: white;">
    <nav id="filter-nav" class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <ul id="menu-left" class="nav navbar-nav">
        <li class="active" id="menu-back"><a ng-href="articles.html?loi={{loi}}">&lt; Voir les articles du texte</a></li>
        <li class="dropdown" id="menu-display">
          <span ng-cloak class="dropdown-toggle" data-toggle="dropdown">
            Vue {{ group ? 'groupée' : 'par articles' }}
            <b class="caret"></b>
          </span>
          <ul class="dropdown-menu" role="menu" id="display_menu">
            <li><a class="{{ group ? '' : 'chosen' }}" ng-click="group = false">par articles</a></li>
            <li><a class="{{ group ? 'chosen' : '' }}" ng-click="group = true">groupée</a></li>
          </ul>
        </li>
        <li class="dropdown" id="menu-order">
          <span ng-cloak class="dropdown-toggle" data-toggle="dropdown">
            Trié par {{ sortOrder === 'sort' ? 'sort final' : (sortOrder === 'groupe' ? 'groupe politique' : 'numéro') }}
            <b class="caret"></b>
          </span>
          <ul class="dropdown-menu" role="menu">
            <li><a class="{{ sortOrder === 'sort' ? 'chosen' : '' }}" ng-click="sortOrder = 'sort'">sort final</a></li>
            <li><a class="{{ sortOrder === 'groupe' ? 'chosen' : '' }}" ng-click="sortOrder = 'groupe'">groupe politique</a></li>
            <li><a class="{{ sortOrder === 'numero' ? 'chosen' : '' }}" ng-click="sortOrder = 'numero'">numéro</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav" id="menu-right">
      <li id="menu-zoom">&nbsp;</li>
      <tutorial mod="mod2"></tutorial>
      </ul>
    </div>
    </nav>
  </div>
</div>

<div class="row">
  <div class="col-md-12 viz-container">
     <div class="scrolling">
        <div class="labels-sc">
          <div class="stages shift-steps">
              <div stepsbar></div>
          </div>
        </div>

        <div class="main-sc">
          <div id="viz" class="{{ data.colonnes }} {{ article ? 'focus-mode' : '' }}" ng-click="focusSubject($event)">
            <div ng-cloak class="sujet {{ article === sujet.article ? 'focus' : '' }}" ng-repeat="sujet in data.sujets" data-article="{{ sujet.article }}">
              <div class="titre" ng-click="focusSubject($event, sujet.article)">{{ sujet.titre }}</div>
              <div class="amendements">
                <div class="amendement amendement-{{ amdt.id_api }}"
                  style="background-color: {{ amdt.color }}; background-image: url({{ amdt.sort_image }});"      
                  ng-click="selectAmdt(amdt)"          
                  ng-repeat="amdt in sujet.amendements">
                  <div class="amendement-tooltip">
                    <div class="numero">Amendement {{ amdt.numero }}</div>
                    <div class="groupe">{{ amdt.nom_groupe }}</div>
                    <div class="sort">Sort: {{ amdt.sort }}</div>
                    <div class="date">{{ amdt.date }}</div>
                    <div class="arrow"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="legend">
          LÉGENDE
          <div class="colors">
            <div class="leg-item" ng-repeat="(key, groupe) in data.legende.groupes">
              <div class="leg-value" style="background-color: {{ groupe.cssColor }};"></div>
              <div class="leg-key">{{ key }}</div>
            </div>
          </div>
          <div class="others">
            <span ng-if="data.groupes.Gouvernement">
              <div class="leg-item" ng-repeat="groupe in [data.groupes.Gouvernement]">
                <div class="leg-value" style="background-color: {{ groupe.cssColor }};"></div>
                <div class="leg-key">Gouvernement</div>
              </div>
              <div class="leg-item"></div>
            </span>
            <div class="leg-item" ng-repeat="(sort, image) in data.legende.sorts">
              <div class="leg-value leg-sort" style="background-image: url({{ image }});"></div>
              <div class="leg-key">{{ sort }}</div>
            </div>
          </div>
        </div>
        <div class="clear"></div>
      </div>

      <div class="text">

        <div id="readMode" style="display:initial;" ng-if="selectedAmdt">
          <div ng-hide="read" class="interactive readMode" ng-click="readmode()" data-toggle="tooltip" title="Déployer le panneau" data-placement="bottom" data-original-title="Déployer le panneau"><span class="glyphicon glyphicon-chevron-left"></span></div>
          <div ng-show="read" class="interactive readMode" ng-click="viewmode()" data-toggle="tooltip" title="Replier le panneau" data-placement="bottom" data-original-title="Déployer le panneau"><span class="glyphicon glyphicon-chevron-right"></div>
        </div>

        <h4 id="text-title">
          {{ selectedAmdt ? 'Amendement ' + selectedAmdt.numero : 'AMENDEMENTS' }}
        </h4>
        <div id="load_amd"></div>
        <div class="text-container">
          <div ng-cloak ng-if="selectedAmdtData">
            <span class="amd-date">{{ d3.time.format("%d/%m/%Y")(d3.time.format("%Y-%m-%d").parse(selectedAmdt.date)) }}</span>
            <span class="amd-sort">
              {{ selectedAmdtData.sort }}
              <span class="amd-txt-status" style="background-color:{{ selectedAmdt.color }}">
                <img style="margin:0; padding:4px; width:18px;" src="{{ selectedAmdt.sort_image }}" />
              </span>
            </span>
            <div class="amd-subject">
              <b>Sujet :</b>
              <span>{{ selectedAmdtData.sujet }}</span>
            </div>
            <div class="amd-text">
              <b>Signataires :</b>
              <span>{{ selectedAmdtData.signataires }}</span>
            </div>
            <div class="amd-text">
              <b>Exposé des motifs :</b>
              <span ng-bind-html="selectedAmdtData.expose"></span>
            </div>
            <div class="amd-text">
              <b>Texte :</b>
              <span ng-bind-html="selectedAmdtData.texte"></span>
            </div>
            <p class="sources">
              <small>
                <a target="_blank" href="{{ selectedAmdtData.url }}"><span class="glyphicon glyphicon-link"></span>
                  {{ selectedAmdtData.origine === 'an' ? 'NosDéputés' : 'NosSénateurs' }}.fr</a> &nbsp; &nbsp;
                <a target="_blank" href="{{ selectedAmdtData.source }}"><span class="glyphicon glyphicon-link"></span> 
                  {{ selectedAmdtData.origine === 'an' ? 'Assemblée Nationale' : 'Sénat' }}</a>
              </small>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
